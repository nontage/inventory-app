<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>在庫一括入力</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      margin: 10px;
      font-size: 14px;
    }

    h2 {
      font-size: 14px;
      margin: 6px 0;
    }

    .btn-grid-row {
      display: flex;
      justify-content: center;
      gap: 5px;
      margin-bottom: 4px;
    }

    button {
      font-size: 1rem;
      padding: 8px;
      width: 60px;
      height: 60px;
      border-radius: 8px;
    }

    .btn-clear {
      background-color: #a9a9a9 !important;
    }

    .output {
      margin: 5px;
      font-size: 0.95rem;
    }

    #sendAllBtn {
      background: green;
      color: white;
      font-size: 1.1rem;
      margin-top: 15px;
      padding: 10px 20px;
      border-radius: 10px;
    }

    ul {
      padding-left: 0;
      list-style: none;
      font-size: 0.9rem;
    }

    li {
      margin-bottom: 5px;
    }
  </style>
</head>
<body>

  <h2>在庫場所1</h2>
  <div class="btn-grid-row">
    <button onclick="setStock1('T')">T</button>
    <button onclick="setStock1('B')">B</button>
    <button onclick="setStock1('A')">A</button>
  </div>

  <h2>在庫場所2</h2>
  <div class="btn-grid-row">
    <button onclick="addStock2('1')">1</button>
    <button onclick="addStock2('2')">2</button>
    <button onclick="addStock2('3')">3</button>
    <button onclick="addStock2('4')">4</button>
  </div>
  <div class="btn-grid-row">
    <button onclick="addStock2('5')">5</button>
    <button onclick="addStock2('6')">6</button>
    <button onclick="addStock2('7')">7</button>
    <button onclick="addStock2('8')">8</button>
  </div>
  <div class="btn-grid-row">
    <button onclick="addStock2('9')">9</button>
    <button onclick="addStock2('0')">0</button>
    <button onclick="addStock2('00')">00</button>
    <button class="btn-clear" onclick="clearStock2()">C</button>
  </div>

  <h2>種類</h2>
  <div class="btn-grid-row">
    <button onclick="setType('TO')">TO</button>
    <button onclick="setType('BT')">BT</button>
    <button onclick="setType('AC')">AC</button>
    <button onclick="setType('MX')">MX</button>
  </div>

  <h2>番号</h2>
  <div class="btn-grid-row">
    <button onclick="addNumber('1')">1</button>
    <button onclick="addNumber('2')">2</button>
    <button onclick="addNumber('3')">3</button>
    <button onclick="addNumber('4')">4</button>
  </div>
  <div class="btn-grid-row">
    <button onclick="addNumber('5')">5</button>
    <button onclick="addNumber('6')">6</button>
    <button onclick="addNumber('7')">7</button>
    <button onclick="addNumber('8')">8</button>
  </div>
  <div class="btn-grid-row">
    <button onclick="addNumber('9')">9</button>
    <button onclick="addNumber('0')">0</button>
    <button onclick="addNumber('00')">00</button>
    <button class="btn-clear" onclick="clearNumber()">C</button>
  </div>

  <div class="output">
    <p>在庫場所1: <span id="stock1">未選択</span></p>
    <p>在庫場所2: <span id="stock2">0</span></p>
    <p>種類: <span id="type">未選択</span></p>
    <p>番号: <span id="number">0</span></p>
  </div>

  <button onclick="addToQueue()">➕ 一時保存</button>

  <h3>保存中のデータ</h3>
  <ul id="queueList"></ul>

  <button id="sendAllBtn" onclick="sendQueue()">✅ まとめて送信</button>

  <script>
    let stock1 = '';
    let stock2 = '';
    let type = '';
    let number = '';
    const dataQueue = [];

    function setStock1(val) {
      stock1 = val;
      document.getElementById('stock1').textContent = val;
    }

    function addStock2(val) {
      stock2 += val;
      document.getElementById('stock2').textContent = stock2;
    }

    function clearStock2() {
      stock2 = '';
      document.getElementById('stock2').textContent = '0';
    }

    function setType(val) {
      type = val;
      document.getElementById('type').textContent = val;
    }

    function addNumber(val) {
      number += val;
      document.getElementById('number').textContent = number;
    }

    function clearNumber() {
      number = '';
      document.getElementById('number').textContent = '0';
    }

    function addToQueue() {
      if (!stock1 || !stock2 || !type || !number) {
        alert("すべて入力してください");
        return;
      }

      const entry = { stock1, stock2, type, number };
      dataQueue.push(entry);
      updateQueueDisplay();
      clearStock2();
      clearNumber();
    }

    function updateQueueDisplay() {
      const ul = document.getElementById("queueList");
      ul.innerHTML = '';

      dataQueue.forEach((item, index) => {
        const li = document.createElement("li");
        li.textContent = `${index + 1}: ${item.stock1} / ${item.stock2} / ${item.type} / ${item.number}`;

        const deleteBtn = document.createElement("button");
        deleteBtn.textContent = "❌ 削除";
        deleteBtn.style.marginLeft = "8px";
        deleteBtn.onclick = () => {
          dataQueue.splice(index, 1);
          updateQueueDisplay();
        };

        li.appendChild(deleteBtn);
        ul.appendChild(li);
      });
    }

    function sendQueue() {
      if (dataQueue.length === 0) {
        alert("データがありません");
        return;
      }

      const formData = new URLSearchParams();
      formData.append("data", JSON.stringify(dataQueue));

      fetch("https://script.google.com/macros/s/AKfycbwdTt6DzuttxCKS2WMef4IEdlew2wtX0I4s8PHLNvSosTZf1XNsNZW1OrpstQJDR5Jz/exec", {
        method: "POST",
        mode: "no-cors",
        headers: {
          "Content-Type": "application/x-www-form-urlencoded"
        },
        body: formData
      })
      .then(() => {
        alert("まとめて送信完了！");
        dataQueue.length = 0;
        updateQueueDisplay();
      })
      .catch(error => {
        alert("送信失敗：" + error);
      });
    }
  </script>
</body>
</html>
